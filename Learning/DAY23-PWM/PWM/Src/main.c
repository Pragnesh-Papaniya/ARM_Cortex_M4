#include "stm32f4xx.h"
#include <stdint.h>

int main(void)
{
	//ENABLE THE CLOCK ACCESS FOR GPIOA
	RCC->AHB1ENR |=0X01;
	//ENABLE THE CLOCK ACCESS FOR TIM2
	RCC->APB1ENR |=0X01;
	//SET THE GPIOAMODE REGISTER FOR ALTERNATE FUNCTIOM
	GPIOA->MODER |= 0x00000800;
	//AFR
	GPIOA->AFR[0] |= 0x00100000;

	TIM2->PSC =10-1; //DIVIDE TIMER CLK BY 10
	TIM2->ARR =16667-1;
	TIM2->CNT=0;
	TIM2->CCMR1 =0X0060;//ENABLE PWM MODE
	TIM2->CCER=1; //ENABLE PWM CH1
	TIM2->CCR1=8889-1;
	TIM2->CR1=1; //ENABLE THE TIMER
    /* Loop forever */
	for(;;);
}
